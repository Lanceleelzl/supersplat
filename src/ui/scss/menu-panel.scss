@use 'colors.scss' as *;

.menu-panel {
    position: absolute;
    z-index: 2000; // 确保菜单面板在所有其他面板之上

    &:not(.pcui-hidden) {
        display: flex;
    }
    flex-direction: column;

    border-radius: 8px;
    overflow: hidden;

    background-color: $bcg-dark;
    // 默认使用阴影（保持左侧主菜单的视觉）
    filter: drop-shadow(5px 5px 10px rgba(0, 0, 0, 0.8));
    // the following is needed to get drop-shadow working on safari
    will-change: transform;
}

// 右侧工具栏扁平化样式：移除阴影
.menu-panel.menu-panel--flat {
    filter: none !important;
    box-shadow: none !important;
}

// 紧凑样式：用于视图控制菜单
.menu-panel.menu-panel--compact {
    width: 100px;
    min-width: 100px;
    max-width: 100px;
}

.menu-panel.menu-panel--compact .menu-row {
    width: 100px !important;
    min-width: 100px !important; // 强制覆盖默认 180px
    box-sizing: border-box;
}

.menu-panel.menu-panel--compact .menu-row-text {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: clip;
}

.menu-row {
    display: flex;
    flex-direction: row;
    min-width: 180px;
    align-items: center;
    height: 32px;
    padding: 0px 8px;

    svg {
        color: $text-secondary;
        width: 16px;
        height: 16px;
        min-width: 16px;
        min-height: 16px;
        flex-shrink: 0;
        margin-right: 8px;
        display: block;
        visibility: visible;
        opacity: 1;
        
        // Ensure SVG paths inherit the color
        path {
            fill: currentColor;
        }
    }
    
    // 当图标为空时，隐藏图标容器
    &:has(.menu-icon:empty) svg,
    .menu-icon:empty {
        display: none;
    }

    &:hover:not(.pcui-disabled) {
        background-color: $bcg-darkest;
        cursor: pointer;

        & > .menu-row-text, .menu-row-postscript, .menu-row-icon {
            color: $text-primary;
        }

        svg {
            color: $text-primary;
            
            path {
                fill: currentColor;
            }
        }
    }

    // 激活项：仅通过图标颜色区分状态（不使用勾选）
    &.active {
        svg {
            color: $clr-hilight;
            path {
                fill: currentColor;
            }
        }
    }

    &.pcui-disabled {
        & > .menu-row-text, .menu-row-postscript, .menu-row-icon {
            color: $text-darkest;
        }

        svg {
            color: $text-darkest;
            
            path {
                fill: currentColor;
            }
        }
    }

    // tweaks for attached boolean toggles
    > .pcui-boolean-input {
        background-color: $bcg-darkest;
        border-radius: 2px;
        &.pcui-boolean-input-ticked {
            background-color: $clr-hilight;
            &::after {
                color: $text-primary;
            }
        }
    }
}

.menu-row-icon {
    font-family: 'pc-icon' !important;
}

.menu-row-text {
    flex-grow: 1;
}

.menu-row-postscript {
    color: $text-dark;
}

.menu-row-separator {
    height: 1px;
    background-color: $bcg-light;
}