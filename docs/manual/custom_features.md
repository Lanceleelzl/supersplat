# 二次开发功能手册 (Custom Features Guide)

本文档详细介绍基于 SuperSplat 二次开发的高级功能，包括 GIS 坐标支持、巡检业务流及模型兼容性扩展。

## 1. 巡检系统 (Inspection System)

本项目集成了完整的巡检点位管理与导出流程。

### 1.1 创建巡检点
1. 在工具栏选择 **巡检对象工具 (Inspection Object Tool)**（图标通常为标记点状）。
2. 在 3D 场景中点击任意位置（Splat表面或模型表面）。
3. 系统会自动创建一个带有编号的巡检标记（Marker）。
4. 在右侧场景面板中，可以查看并重命名该巡检点。

### 1.2 导出巡检数据
1. 点击界面上的 **导出巡检参数** 按钮（或相关菜单项）。
2. 打开 **导出面板**，系统会自动计算以下信息：
   - **点位名称**: 巡检点的名称。
   - **ENU 坐标**: 基于原点的相对坐标。
   - **经纬度/海拔**: 根据设置的 EPSG 和原点参数自动转换的地理坐标。
   - **云台角度**: 包含 Pitch/Yaw 角度信息。
3. 点击导出，系统将生成 `.xlsx` (Excel) 文件，包含所有勾选的参数。

## 2. 坐标系统与工具 (Coordinate System)

为了支持 GIS 业务，系统引入了真实地理坐标系支持。

### 2.1 坐标查询工具 (Coordinate Lookup)
- **功能**: 实时查询场景中任意点的坐标信息。
- **操作**: 点击工具栏的 **坐标查询** 图标，鼠标悬停或点击场景表面，即可显示当前点的坐标。
- **EPSG 支持**: 系统内置了对 UTM 投影（EPSG:326xx/327xx）的解析能力，可自动识别带号。

### 2.2 原点设置 (Origin Settings)
- **入口**: 通过菜单或导出面板进入 **原点设置**。
- **参数**:
  - **EPSG 编码**: 输入目标坐标系的 EPSG 代码。
  - **原点坐标**: 设置场景 (0,0,0) 点对应的真实地理坐标（ENU 或经纬度）。
- **作用**: 所有的导出数据将基于此原点进行逆算，确保导出的数据可直接用于 GIS 软件。

## 3. GLB 模型支持 (GLB Support)

系统增强了对标准 GLTF/GLB 模型的支持，使其能与 Gaussian Splat 场景混合编辑。

### 3.1 模型交互
- **加载**: 支持直接拖拽 `.glb` / `.gltf` 文件到场景中。
- **混合渲染**: GLB 模型能与 Splat 点云正确遮挡与混合渲染。
- **右键菜单**:
  - **复制 (Duplicate)**: 支持原位复制模型。
  - **删除 (Delete)**: 移除模型。
  - **隐藏/显示**: 快速切换模型可见性。

### 3.2 拾取与对齐
- 修复了原生引擎中 GLB 模型射线检测不准确的问题，现在可以精确地在 GLB 模型表面进行拾取、测量和放置巡检点。

## 4. 其他增强 (Other Enhancements)

- **Excel 导出器**: 内置 `xlsx` 库，支持将场景数据、属性列表导出为标准 Excel 表格。
- **UI 交互优化**:
  - 修复了属性面板点击与场景选择的冲突。
  - 优化了拖拽视角时的误触问题。
  - 增加了大量中文 Tooltips 提示，降低使用门槛。
