# 6A工作流执行规则 (Optimized)

## 0. 快速通道 (Fast Track) & AI 自动驾驶模式

### 适用场景
- 简单的功能添加或修改
- Bug 修复
- 单文件/少文件修改
- 用户明确要求 "直接写代码"

### 执行准则 (AI Auto-Pilot)
1.  **跳过繁琐文档**：直接跳过标准流程的文档阶段。
2.  **简要分析**：在对话中简要说明修改计划。
3.  **直接执行**：直接进行代码修改。
    - **全自动代写**：禁止使用 "TODO" 占位符。
    - **语言要求**：对话、任务列表及所有文档输出必须为中文，关键代码注释中文。
4.  **验证**：修改完成后，提供验证方法或自动运行测试。

---

## 标准通道 (Standard Track) - 优化版 6A 流程

适用于复杂功能开发或系统级重构。

### 文档治理策略 (核心)
- **总索引 (`docs/说明文档.md`)**：项目全生命周期的**总进度表**。仅记录项目规划、当前活跃任务链接、整体进度。
- **任务详情 (`docs/任务名/*.md`)**：具体任务的详细设计与执行记录。任务结束后可归档。

### 阶段 1: Design & Plan (设计与规划)
**合并原 Align & Architect 阶段**
- **目标**：从需求到技术方案。
- **执行**：
  1. 分析需求与项目上下文。
  2. 生成 `docs/任务名/SPEC_[任务名].md`：
     - 需求定义与边界。
     - 系统架构与接口设计 (Mermaid 图)。
     - 关键技术决策。
- **质量门控**：方案可行，无歧义。

### 阶段 2: Task Breakdown (任务拆解)
**合并原 Atomize & Approve 阶段**
- **目标**：将方案拆解为可执行的原子任务。
- **执行**：
  1. 生成 `docs/任务名/PLAN_[任务名].md`：
     - 原子任务清单 (ToDo List) - **必须使用中文**。
     - 依赖关系与执行顺序 - **必须使用中文**。
     - 每个任务的验收标准 - **必须使用中文**。
- **质量门控**：任务粒度合适，可独立验证。

### 阶段 3: Execution (自动化执行)
**原 Automate 阶段**
- **目标**：按计划执行代码编写与测试。
- **执行**：
  1. 严格按 `PLAN` 顺序执行。
  2. **实时更新**：每完成一个任务，在 `PLAN` 文档中标记完成。
  3. **代码质量**：遵循项目规范，添加必要的中文注释。
  4. **验证优先**：每一步修改必须配套验证/测试。

### 阶段 4: Assessment & Cleanup (评估与交付)
**原 Assess 阶段**
- **目标**：验收成果，清理现场。
- **执行**：
  1. 验证所有功能与验收标准。
  2. 生成 `docs/任务名/REPORT_[任务名].md`：
     - 交付物清单。
     - 遗留 TODO (如果有)。
  3. **同步总索引**：将核心成果更新回 `docs/说明文档.md`。
  4. **清理上下文**：建议用户移除不再需要的中间文档，保持 AI 上下文清爽。

---

## 技术执行规范

### 安全与环境
- API 密钥放入 `.env`。
- 统一使用 Windows + Trae 环境。

### 验证机制 (替代"绝不允许出错")
- **允许试错，但必须纠错**：开发过程中遇到错误需立即暂停修复。
- **零错误交付**：最终交付的代码必须通过所有检查和测试。
